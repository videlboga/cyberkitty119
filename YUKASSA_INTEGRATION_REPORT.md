# üí≥ –û—Ç—á–µ—Ç –æ–± –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ÆKassa

**–î–∞—Ç–∞:** 14 –∏—é–ª—è 2025  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2 —á–∞—Å–∞  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω SDK –ÆKassa: `pip install yookassa==3.5.0`
- [x] –°–æ–∑–¥–∞–Ω –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `.env` —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ÆKassa
- [x] –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞: `7922755841:AAFcJTREAPdE37-iBnWwCgfLsicPllbD_J4`

### 2. üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª—è –ÆKassa
- [x] –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `transkribator_modules/payments/yukassa.py`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `YukassaPaymentService`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:
  - `create_payment()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
  - `verify_payment()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
  - `get_plan_price()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø–ª–∞–Ω–∞
  - `get_plan_description()` - –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞–Ω–∞
  - `process_webhook()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤

### 3. üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É –ø–ª–∞—Ç–µ–∂–µ–π
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `transkribator_modules/bot/payments.py`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
  - `choose_payment_method()` - –≤—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
  - `create_yukassa_payment()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –ÆKassa
  - `check_yukassa_payment()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
  - `activate_plan_after_payment()` - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–∞
- [x] –û–±–Ω–æ–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ callback'–æ–≤
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥:
  - `choose_payment_*` - –≤—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
  - `pay_yukassa_*` - –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –ÆKassa
  - `pay_stars_*` - –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Telegram Stars
  - `check_yukassa_*` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### 4. üåê API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `api_server.py`:
  - `POST /yukassa-webhook` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤
  - `HEAD /yukassa-webhook` - –ø—Ä–æ–≤–µ—Ä–∫–∞ URL
  - `GET /yukassa-status` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–ª–∞–Ω–æ–≤

### 5. ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `transkribator_modules/config.py`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
  - `YUKASSA_SHOP_ID`
  - `YUKASSA_SECRET_KEY`
  - `YUKASSA_WEBHOOK_SECRET`

---

## üí∞ –¶–µ–Ω—ã –ø–ª–∞–Ω–æ–≤ –≤ –ÆKassa

| –ü–ª–∞–Ω | –¶–µ–Ω–∞ (‚ÇΩ) | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| Basic | 990 | 180 –º–∏–Ω—É—Ç –≤ –º–µ—Å—è—Ü |
| Pro | 2990 | 600 –º–∏–Ω—É—Ç –≤ –º–µ—Å—è—Ü + API |
| Unlimited | 9990 | –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –º–∏–Ω—É—Ç—ã + VIP |

---

## üîó Webhook URL

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa:
```
https://your-domain.com/yukassa-webhook
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:
- [x] –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è –ÆKassa
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
- [x] –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω –ø–ª–∞–Ω–æ–≤
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞—Ç–µ–∂–µ–π

### üîÑ –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–∞ –æ—Ç –ÆKassa
- [ ] –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa:**
   - –î–æ–±–∞–≤–∏—Ç—å webhook URL
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Shop ID –∏ Secret Key
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
   - –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É webhook'–∞
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–ª–∞–Ω–∞

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –û–±–Ω–æ–≤–∏—Ç—å README
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ÆKassa **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞** –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç:

- –í—ã–±–∏—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã (–ÆKassa –∏–ª–∏ Telegram Stars)
- –û–ø–ª–∞—á–∏–≤–∞—Ç—å –ø–ª–∞–Ω—ã –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏
- –ü–æ–ª—É—á–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–ª–∞–Ω–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–µ–π

**–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** 2 —á–∞—Å–∞  
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~400  
**–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 5 